<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Checkout | ZAYNAR</title>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;600&family=Mulish:wght@300;400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link rel="stylesheet" href="style.css">
    <link rel="icon" href="img/logo.jpg" />
    <style>
        .checkout { max-width: 900px; margin: 140px auto 100px; padding: 0 20px; }
        .card { background: var(--bg-panel); padding: 45px; border-radius: 16px; border: 1px solid var(--border-color); box-shadow: var(--shadow-card); }
        .form-control { width: 100%; padding: 18px; background: var(--bg-body); border: 1px solid var(--border-color); color: white; border-radius: 10px; margin-bottom: 22px; font-size: 1.1rem; }
        .form-control:focus { border-color: var(--accent-gold); outline: none; }

        .btn { width: 100%; padding: 22px; font-size: 1.4rem; border: none; border-radius: 14px; cursor: pointer;
                display: flex; align-items: center; justify-content: center; gap: 15px; font-weight: 700; margin-top: 15px; }
        .btn-whatsapp { background: #25D366; color: white; }
        .btn-whatsapp:hover { background: #128C7E; }
        .btn-instagram { background: linear-gradient(45deg, #833AB4, #C13584, #E1306C, #FD1D1D); color: white; }
        .btn-instagram:hover { opacity: 0.92; }

        .order-box { background: var(--bg-body); padding: 25px; border-radius: 12px; margin: 35px 0; }
        .order-box h3 { color: var(--accent-gold); margin-bottom: 15px; text-align:center; }
    </style>
</head>
<body>

<header id="main-header" style="position:fixed; background:rgba(0,0,0,0.6); backdrop-filter:blur(15px);">
    <div class="header-inner"><a href="index.html" class="brand-logo">ZAYNAR</a></div>
</header>

<div class="checkout">
    <div class="card fade-up">
        <h2 style="text-align:center; margin-bottom:35px; font-size:3rem;">Complete Your Order</h2>

        <input type="text" id="name" class="form-control" placeholder="Full Name *" required>
        <input type="tel" id="phone" class="form-control" placeholder="WhatsApp Number (+923xxxxxxxxx) *" required>
        <input type="text" id="address" class="form-control" placeholder="Full Delivery Address (House#, Street, Area) *" required>
        
        <select id="city" class="form-control" required>
            <option value="">Select City *</option>
            <option>Lahore</option><option>Karachi</option><option>Islamabad</option><option>Rawalpindi</option>
            <option>Faisalabad</option><option>Multan</option><option>Gujranwala</option><option>Peshawar</option><option>Other</option>
        </select>

        <div class="order-box">
            <h3>Your Order Summary</h3>
            <div id="order-items" style="line-height:2.2; font-size:1.1rem;"></div>
            <div style="border-top:2px solid var(--accent-gold); padding-top:20px; margin-top:20px; font-size:1.5rem; text-align:center; color:var(--accent-gold); font-weight:700;" id="final-total"></div>
        </div>

        <!-- WhatsApp Button -->
        <button id="whatsapp-btn" class="btn btn-whatsapp">
            <i class="fa-brands fa-whatsapp fa-2x"></i>
            Order via WhatsApp (Recommended)
        </button>

        <!-- Instagram Button -->
        <button id="instagram-btn" class="btn btn-instagram">
            <i class="fa-brands fa-instagram fa-2x"></i>
            Order via Instagram DM
        </button>

        <p style="text-align:center; margin-top:30px; color:var(--text-secondary);">
            Choose any option — your complete order will be auto-filled and ready to send!
        </p>
    </div>
</div>

<script src="script.js"></script>
<script>
document.addEventListener('DOMContentLoaded', () => {
    const cart = JSON.parse(localStorage.getItem('cart')) || [];

    if (cart.length === 0) {
        alert('Cart is empty!');
        window.location.href = 'shop.html';
        return;
    }

    let subtotal = 0;
    const itemsDiv = document.getElementById('order-items');

    cart.forEach(item => {
        const itemTotal = item.price * item.qty;
        subtotal += itemTotal;
        itemsDiv.innerHTML += `<div>${item.name} × ${item.qty} = <strong>$${itemTotal}</strong></div>`;
    });

    const shipping = 5;
    const total = subtotal + shipping;
    document.getElementById('final-total').innerHTML = `Total: <span style="font-size:1.8rem;">$${total.toFixed(2)}</span> (incl. shipping)`;

    function generateMessage() {
        const name = document.getElementById('name').value.trim();
        const phone = document.getElementById('phone').value.trim();
        const address = document.getElementById('address').value.trim();
        const city = document.getElementById('city').value;

        if (!name || !phone || !address || !city) {
            alert('Please fill all fields first!');
            return null;
        }

        let msg = `*NEW ORDER - ZAYNAR LUXURY*%0A%0A`;
        msg += `Name: ${name}%0A`;
        msg += `Phone: ${phone}%0A`;
        msg += `Address: ${address}, ${city}%0A%0A`;
        msg += `*Items:*%0A`;
        cart.forEach(item => {
            msg += `• ${item.name} × ${item.qty} = $${item.price * item.qty}%0A`;
        });
        msg += `%0ASubtotal: $${subtotal.toFixed(2)}%0A`;
        msg += `Shipping: $5%0A`;
        msg += `*TOTAL: $${total.toFixed(2)}*%0A%0A`;
        msg += `Payment: Cash on Delivery%0A`;
        msg += `Thank you ✨ ZAYNAR`;

        return msg;
    }

    // === WHATSAPP ===
    document.getElementById('whatsapp-btn').addEventListener('click', () => {
        const text = generateMessage();
        if (!text) return;

        // ⚠️ CHANGE THIS TO YOUR REAL WHATSAPP NUMBER
        const waNumber = "923446393926"; // ← Put your number here

        window.open(`https://wa.me/${waNumber}?text=${text}`, '_blank');

        setTimeout(() => { localStorage.removeItem('cart'); updateCartUI(); }, 2000);
    });

    // === INSTAGRAM ===
    document.getElementById('instagram-btn').addEventListener('click', () => {
        const text = generateMessage();
        if (!text) return;

        // ⚠️ CHANGE THIS TO YOUR REAL INSTAGRAM USERNAME (without @)
        const igUsername = "ZAYNAR"; // ← Put your IG username here

        const encoded = encodeURIComponent(decodeURIComponent(text)); // double encode fix
        window.open(`https://www.instagram.com/direct/inbox/?text=${encoded}`, '_blank');
        
        // Optional fallback for some phones
        setTimeout(() => {
            if (!document.hidden) {
                window.open(`instagram://user?username=${igUsername}`);
            }
        }, 1000);

        setTimeout(() => { localStorage.removeItem('cart'); updateCartUI(); }, 2000);
    });
});
</script>

</body>
</html>